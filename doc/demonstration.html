<h2>Short Demonstration</h2>

<p>
  We quickly present some <em>OCaml</em> code allowing to load a full program
  and to transform it into <em>JBir</em> intermediate representation.

  <h3>Loading a program</h3>

  Given an archive <b>test.jar</b> containing a class
  named <b>Test.class</b> defining a <b>main</b> method, we can load
  the corresponding program, assuming that
  the <strong>$CLASSPATH</strong> environment variable contains the
  <strong>test.jar</strong> file and the <em>Java
  Runtime</em> <strong>rt.jar</strong>.
  
<p>
  <pre><code>    open Javalib
    let cp = class_path (Sys.getenv "CLASSPATH")
    let (prta,instantiated_classes) =
      JRTA.parse_program cp (make_cn "Test", JProgram.main_signature)
    let () = close_class_path cp
  </code></pre>
<p>

It can be interesting to generate the <strong>.html</strong> files corresponding to the parsed program <strong>prta</strong>.

<p>
  <pre><code>    let output = "/tmp/test"
    let () =
      JPrintHtml.pp_print_program_to_html_files prta output JPrintHtml.void_info
  </code></pre>
</p>

  <h3>Transforming a program</h3>

We transform the previously loaded program.

<p>
  <pre><code>    let pbir = map_program2
      (fun _ -&gt; JBir.transform ~compress:false) prta
  </code></pre>
</p>

To see how <em>JBir</em> representation looks like, we can
pretty-print one class to the standard output, for
instance <strong>java.lang.Object</strong>.

<p>
  <pre><code>    let obj = get_node pbir JBasics.java_lang_object
    let () = JPrint.print_class (JProgram.to_jclass obj) JBir.print stdout
  </code></pre>
</p>

</p>
